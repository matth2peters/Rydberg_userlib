Currently, all of this code is taken from Zak's. 